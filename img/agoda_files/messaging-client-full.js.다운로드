!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=108)}({0:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return a}),n.d(t,"e",function(){return f});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{a(r.next(e))}catch(e){o(e)}}function u(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,u)}a((r=r.apply(e,t||[])).next())})}function u(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function a(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}},1:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return r});var r=function(){function t(){}return t.current=function(){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==e?e:null;if(!t)throw new Error("Unsupported environment.");return t},t}()}).call(this,n(24))},10:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1),i="MessagingClient-LiteData",o=function(){function e(){}return e.get=function(){var e=r.a.current();return e[i]||(e[i]={})},e.clear=function(){delete r.a.current()[i]},e}()},108:function(e,t,n){"use strict";n.r(t);var r=n(0),i=function(){function e(e){this.cookie=e}return e.current=function(){if("undefined"!=typeof document&&"string"==typeof document.cookie)try{return new e(document.cookie||"")}catch(e){}},e.prototype.value=function(e){var t=("; "+this.cookie).split("; "+e+"=");if(2===t.length){var n=t.pop();if(n)return n.split(";").shift()}},e}(),o=function(){function e(){}return e.default=function(e){return void 0===e&&(e=i.current()),e?{sessionId:this.sessionId(e),userId:this.userId(e)}:{}},e.userId=function(e){var t=e.value("agoda.user.03");if(t){var n=t.split("=");if(2===n.length)return n[1]}},e.sessionId=function(e){return e.value("ASP.NET_SessionId")},e}(),s=n(68),u=function(){function e(e){void 0===e&&(e=o.default()),this.context=e,this.workerUrl="",this.polyfillsUrl="/messaging-client-polyfills.js",this.apiKey="",this.forcePolyfills=!1,this.fakeMode=!1,this.debug=!1,this.mode="production",this.performanceAudit=!1,this.disable=!1}return e.merge=function(t,n){return void 0===n&&(n=new e),"development"===t.mode&&"boolean"!=typeof t.debug&&(t.debug=!0),Object(s.a)(n,t,{context:r.a({},n.context,t.context)})},e.prototype.validate=function(){if(!this.apiKey)throw new Error("ApiKey is required but not defined or empty.");if(!this.workerUrl)throw new Error("WorkerUrl is required but not defined or empty.")},e}(),a=n(22),c=n(10),f=n(17),l=function(){function e(){}return e.prototype.fatal=function(e,t){this.send({type:"log",log:{level:"fatal",message:e,error:t}})},e.prototype.error=function(e,t){this.send({type:"log",log:{level:"error",message:e,error:t}})},e.prototype.log=function(e){this.send({type:"log",log:{level:"log",message:e}})},e.prototype.extensionId=function(){return f.a.current().extensionId},e.prototype.send=function(e){if("undefined"!=typeof chrome&&chrome.runtime&&"function"==typeof chrome.runtime.sendMessage){var t=this.extensionId();t&&chrome.runtime.sendMessage(t,e)}},e}(),p=n(1),h=function(){function e(e){this._options=e,this.prefix="[messaging-client.js]: "}return e.prototype.fatal=function(e,t){this.error(e,t)},e.prototype.error=function(e,t){var n=this;(e||t)&&this.do(function(r){r.error(n.prefix+e,t)})},e.prototype.log=function(e){var t=this;e&&this.do(function(n){n.log(t.prefix+e)})},e.prototype.do=function(t){var n=e._global.console;!this._options.mute&&n&&t(n)},e._global=p.a.current(),e}(),d=n(16),v=function(){function e(){this.onlog=new d.a}return e.prototype.fatal=function(e,t){this.onlog.emit({level:"fatal",message:e,error:t})},e.prototype.error=function(e,t){this.onlog.emit({level:"error",message:e,error:t})},e.prototype.log=function(e){this.onlog.emit({level:"log",message:e})},e}(),g=n(52),y=function(){function e(){}return e.prototype.send=function(e){},e.prototype.dispose=function(e){e&&e()},e.prototype.environment=function(e){},e.prototype.context=function(e){},e}(),m=function(e){return{endpoints:[{type:"fe-analytic-collector",url:"production"===e?["https://analytics.agoda.com","https://bento.agoda.com"]:"//hkg-gc-qa.agoda.local",timeout:6e4,queues:[{id:"default",flushTime:1e3,maxFlushTime:3e4,batchSize:50,maxMessageCount:15e3,maxEnqueueCount:300,persistent:!0,attemptCount:2,fillThreshold:.6}]}]}},_=n(9),b=function(){function e(e){var t=this;this._action=e,this._buffer=new Array,this.flush=function(){try{0!==t._buffer.length&&t._action(t._buffer)}finally{t.clear()}}}return e.prototype.call=function(e,t){var n;void 0===t&&(t=!1),(n=this._buffer).push.apply(n,r.e(e)),t?this.flush():this.timeoutId||(this.timeoutId=setTimeout(this.flush),_.a.addListener(this.flush))},e.prototype.clear=function(){this._buffer=new Array,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),_.a.removeListener(this.flush)},e}(),w=function(){function e(){}return e.log=function(t,n){t.log.subscribe(function(t){return e.printLog(n,t)})},e.printLog=function(e,t){switch(t.level){case"log":e.log(t.message);break;case"error":e.error(t.message,t.error);break;case"fatal":e.fatal(t.message,t.error);break;default:e.log(t.message)}},e}(),x=n(31),k=n(30),E=n(7),j=n(32),O=function(){function e(e,t){this.ajax=new k.b("{}"),this.receiver=new x.a(e,t),this._ajax=new j.a("ajax",e,this.receiver,this.ajax),this._log=new E.a("log",this.receiver),this._performance=new E.a("performance",this.receiver),this.log=this._log.event.map(function(e){return e.log}),this.performance=this._performance.event.map(function(e){return e.report})}return e.prototype.dispose=function(){this._ajax.dispose(),this._log.dispose(),this._performance.dispose()},e}(),M=n(33),L=n(23),S=function(){function e(){}return e.isSupported=function(){return"undefined"!=typeof navigator&&"serviceWorker"in navigator},e.activate=function(t,n,r){void 0===r&&(r=3);var i=0;return navigator.serviceWorker.register(t,{scope:n}).then(function(o){i++;var s=o.active||o.installing||o.waiting;return s&&"activated"===s.state?{registration:o,serviceWorker:s}:s?new Promise(function(u,a){function c(e){s.onstatechange=s.onerror=void 0,e()}s.onstatechange=function(f){"activated"===s.state&&c(function(){return u({registration:o,serviceWorker:s})}),"redundant"===s.state&&c(i<r?function(){return u(e.activate(t,n))}:function(){return a("Registration was failed with maximum attempts exceeds.")})},s.onerror=function(e){c(function(){return a(e.target)})}}):Promise.reject("ServiceWorker failed the registration.")})},e.absoluteScope=function(e,t){return"undefined"!=typeof location&&location&&location.pathname&&(e=Object(L.a)(location.pathname,e)),Object(L.a)(e,t)},e}(),I=n(18),W=function(){return function(e){var t=this;this._async=e,this.call=function(e){return t._obj?e(t._obj):t._async.then(function(t){return e(t)})},this._async.then(function(e){t._obj=e})}}(),P=function(){function e(e,t,n){void 0===n&&(n=navigator.serviceWorker),this.registration=e,this.serviceWorker=t,this.container=n,this.subscribe()}return e.create=function(t){if(S.isSupported()){var n=S.absoluteScope(t,"massaging-client");return S.activate(t,n).then(function(t){return new e(t.registration,t.serviceWorker)})}return Promise.reject(new Error("ServiceWorker is unsupported"))},e.prototype.addEventListener=function(e,t){this.container.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.container.removeEventListener(e,t)},e.prototype.terminate=function(){return this.serviceWorker.onstatechange=void 0,this.registration.unregister()},e.prototype.postMessage=function(e){"redundant"!==this.serviceWorker.state&&this.serviceWorker.postMessage(e)},e.prototype.subscribe=function(){var e=this,t=this.serviceWorker;t.onstatechange=function(){"redundant"===t.state&&(t.onstatechange=void 0,e.container.getRegistration.call(e.container,e.registration.scope).then(function(n){n&&(e.registration=n,e.serviceWorker=n.active||n.installing||n.waiting||t,e.subscribe())}))}},e}(),C=function(){function e(e,t){var n=P.create(e).catch(function(e){return t(e)});this._sync=new W(n)}return e.prototype.addEventListener=function(e,t){this._sync.call(function(n){return n.addEventListener(e,t)})},e.prototype.removeEventListener=function(e,t){this._sync.call(function(n){return n.removeEventListener(e,t)})},e.prototype.terminate=function(){return this._sync.call(function(e){return e.terminate()})},e.prototype.postMessage=function(e){this._sync.call(function(t){return t.postMessage(e)})},e}(),T=function(){function e(e,t,n){this._path=e,this._workers=t,this._logger=n}return e.prototype.new=function(){var e=this.supportedWorker(this._workers);return this.create(e)},e.prototype.create=function(e){switch(this._logger.log("Creating worker: '"+e+"'"),e){case"service":return this.serviceWorker();case"emulated":return this.emulatedWorker()}},e.prototype.emulatedWorker=function(){return new I.a(this._path)},e.prototype.serviceWorker=function(){var e=this;return new C(this._path,function(t){return e._logger.error(t.stack),e.create(e.supportedWorker(["emulated"]))})},e.prototype.supportedWorker=function(e){return void 0===e&&(e=["service","emulated"]),S.isSupported()&&e.indexOf("service")>=0?"service":e.indexOf("emulated")>=0?"emulated":this.supportedWorker()},e}(),A=function(){function e(e,t,n){void 0===n&&(n=null),this._logger=t,this._disposed=!1,n=n||m(e.mode);var r=new T(e.workerUrl,n.workers||[],t),i=this._worker=r.new();this._receiver=new O(i,t),this._terminateCommand=new M.a("terminate",i,this._receiver.receiver),w.log(this._receiver,this._logger),this._configuration={type:"configuration",configuration:n,environment:e},i.postMessage(this._configuration),this._sendMessages=new b(function(e){i.postMessage({type:"messages",messages:e})}),this.ping()}return Object.defineProperty(e.prototype,"ajax",{get:function(){return this._receiver.ajax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"performance",{get:function(){return this._receiver.performance},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t){this._sendMessages.call(e,t&&t.sync)},e.prototype.environment=function(e){this._worker.postMessage({type:"environment",environment:e})},e.prototype.context=function(e){this._worker.postMessage({type:"context",data:e})},e.prototype.dispose=function(e){var t=this,n=e||function(){};if(this._disposed)n();else{this._disposed=!0,this._pingIntervalId&&clearInterval(this._pingIntervalId);var r=this._worker,i=function(){try{t._sendMessages.clear(),t._receiver.dispose()}finally{var e=r.terminate();e&&"function"==typeof e.then?e.then(function(){return n()}):n()}};this._terminateCommand.send(void 0,i,i)}},e.prototype.ping=function(){var e=this;this._pingIntervalId=setInterval(function(){e._worker.postMessage(e._configuration)},5e3)},e}(),q=n(34);n.d(t,"MessagingClient",function(){return U});var U=function(){function e(e){this._testEnvironment=e}return e.environment=function(t){return new e(t)},e.create=function(t){return"production"!==t.mode&&console.log("Method MessagingClient.create() is deprecated. Please use MessagingClient.instantiate() method instead."),e.instantiate(t)},e.instantiate=function(t){return(new e).instantiate(t)},e.reinstantiate=function(t){c.a.get().messagingClient&&(new e).instantiate(t)},e.terminate=function(e){var t=c.a.get();t.messagingClient?t.messagingClient.sender.dispose(e):e&&e(),c.a.clear()},e.initialize=function(t){if(!t.environment)throw new Error("Environment parameter is strongly required.");var n=e.sender(t.environment,t.test),r=t.messagingClient;return r?r.sender=n:r=new q.a(n,new a.a),e.sendBufferedData(t,n),t.isFullVersion=!0,r},e.prototype.instantiate=function(t){var n=c.a.get();if(n.environment&&t)throw new Error("Configuration of MessagingClientJS is already set. Please provide configuration only once.");if(n.messagingClient&&n.isFullVersion)return n.messagingClient;if(n.environment=n.environment||t,n.environment&&(n.test=n.test||this._testEnvironment,n.messagingClient=e.initialize(n)),n.messagingClient)return n.messagingClient;throw new Error("Lite version of MessagingClientJS was not loaded. Please provide a configuration to instantiate a full version.")},e.logger=function(e,t){var n=new g.a([new h({mute:!t.debug}),new l]);if(e&&e.listeners&&e.listeners.log){var r=new v;r.onlog.subscribe(e.listeners.log),n.loggers.push(r)}return n},e.sender=function(t,n){var r=u.merge(t);if(r.validate(),r.disable)return new y;var i=e.logger(n,t),o=new A(r,i,n?n.configuration:null);return n&&n.listeners&&(n.listeners.ajax&&(o.ajax.handler=function(e){return n.listeners&&n.listeners.ajax&&n.listeners.ajax(e)||""}),o.performance.subscribe(function(e){return n.listeners&&n.listeners.performance&&n.listeners.performance(e)})),o},e.sendBufferedData=function(e,t){e.context&&(t.context(e.context),e.context=void 0),e.buffer&&(t.send(e.buffer.items),e.buffer.items.length=0,e.buffer=void 0)},e}();U.reinstantiate()},16:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){this._listeners=new Array,this._buffer=new Array}return e.prototype.subscribe=function(e){var t=this;return"function"==typeof e&&(this.subscribed(e)<0&&this._listeners.push(e),this._buffer.length>0&&setTimeout(function(){return t.flushBuffer()})),this},e.prototype.unsubscribe=function(e){for(var t=this.subscribed(e);t>=0;)this._listeners.splice(t,1),t=this.subscribed(e);return this},e.prototype.clear=function(){this._listeners.length=0,this._buffer.length=0},e.prototype.emit=function(e){var t=this._listeners.length;if(t>0)for(var n=0;n<t;n++)try{this._listeners[n](e)}catch(e){}else this._buffer.push(e)},e.prototype.redirect=function(e){return this.subscribe(function(t){e.emit(t)}),e},e.prototype.map=function(t){var n=new e;return this.subscribe(function(e){n.emit(t(e))}),n},e.prototype.subscribed=function(e){return this._listeners.indexOf(e)},e.prototype.flushBuffer=function(){var e=this._buffer.slice();this._buffer.length=0;for(var t=e.length,n=0;n<t;n++)this.emit(e[n])},e}()},17:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){}return e.current=function(){return window&&window.__MCJS_EXTENSION_DATA__||{}},e}()},18:function(e,t,n){"use strict";var r=n(1),i=function(){function e(t){if(void 0===t&&(t=r.a.current()),void 0===t.document)throw new Error("No DOM environment is not supported.");this.loadScript=function(n,r){return e.loadViaDom(t.document,n,r)}}return e.loadViaDom=function(e,t,n){var r=e.createElement("script");r.type="text/javascript",r.src=t,n&&(r.onload=n),(e.body||e.head).appendChild(r)},e}();n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});var o="MessagingClient-PseudoWorker",s=function(){function e(e,t){void 0===t&&(t=new i);var n=this;this._listeners=[],this._buffer=[],this._global=window,this._pseudoWorker=this._global[o]=new u(e,t,{raiseEvent:function(e){return n.raiseEvent(e)}}),t.loadScript(e)}return Object.defineProperty(e.prototype,"pseudoWorker",{get:function(){return this._pseudoWorker},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._pseudoWorker.raiseEvent({data:e})},e.prototype.addEventListener=function(e,t){var n=this;"message"===e&&(this._listeners.push(t),setTimeout(function(){if(n._buffer.length>0){for(var e=n._buffer.slice(),t=e.length,r=0;r<t;r++)n.raiseEvent(e[r]);n._buffer.length=0}}))},e.prototype.removeEventListener=function(e,t){var n=this._listeners.indexOf(t);n>-1&&this._listeners.splice(n,1)},e.prototype.terminate=function(){this._buffer.length=0,this._listeners.length=0,this._pseudoWorker.close()},e.prototype.raiseEvent=function(e){var t=this._listeners,n=t.length;if(n>0)for(var r=0;r<n;r++){(0,t[r])(e)}else this._buffer.push(e)},e}(),u=function(){function e(e,t,n){this._scriptLoader=t,this._internal=n,this._listeners=[],this._buffer=[],this.location=e}return e.prototype.postMessage=function(e){var t=this;e=JSON.parse(JSON.stringify(e)),setTimeout(function(){t._internal.raiseEvent({data:e})})},e.prototype.importScripts=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=n.length,o=n.length,s=function(){--o<=0&&(t=!0,e&&e())},u=0;u<i;u++)this._scriptLoader.loadScript(n[u],s);return{then:function(n){t?n():e=n}}},e.prototype.addEventListener=function(e,t){var n=this;"message"===e&&(this._listeners.push(t),setTimeout(function(){if(n._buffer.length){for(var e=n._buffer.slice(),t=e.length,r=0;r<t;r++)n.raiseEvent(e[r]);n._buffer.length=0}}))},e.prototype.removeEventListener=function(e,t){var n=this._listeners.indexOf(t);n>-1&&this._listeners.splice(n,1)},e.prototype.raiseEvent=function(e){if(this._listeners.length)for(var t=this._listeners.length,n=0;n<t;n++)this._listeners[n](e);else this._buffer.push(e)},e.prototype.close=function(){this._buffer.length=0,this._listeners.length=0},e}()},22:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){}return e.prototype.now=function(){return+new Date},e}()},23:function(e,t,n){"use strict";function r(e,t){if("/"===t[0])return t;var n=e.lastIndexOf("/");return n<0?"/"+t:e.substring(0,n+1)+t}n.d(t,"a",function(){return r})},24:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},30:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0),i=function(){function e(e,t){var n=this;this.def=e,this.handler=t,this.invoke=function(e){return n.handler?n.handler(e):n.def}}return e.prototype.stop=function(){this.handler=void 0},e}(),o=function(){function e(e){var t=this;this._handler=e,this._buffer=new Array,this.invoke=function(e){return t.handler?t.handler(e):new Promise(function(n,r){t._buffer.push({request:e,resolve:n})})}}return Object.defineProperty(e.prototype,"handler",{get:function(){return this._handler},set:function(e){this._handler=e,this.flushBuffer()},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this.handler=void 0},e.prototype.flushBuffer=function(){var e,t;if(this._handler&&this._buffer.length>0)try{for(var n=r.f(this._buffer),i=n.next();!i.done;i=n.next()){var o=i.value;o.resolve(this.invoke(o.request))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}()},31:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),i=function(){function e(e,t){var n=this;this._receiver=e,this._logger=t,this._dic={},this._buffers={},this._handler=function(e){var t,i,o=e.data;if(o&&o.type){var s=n._dic[o.type];if(s)try{for(var u=r.f(s),a=u.next();!a.done;a=u.next()){var c=a.value;try{c(o)}catch(e){n._logger.error("Error on executing listener for message type "+o.type,e)}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=u.return)&&i.call(u)}finally{if(t)throw t.error}}else(n._buffers[o.type]||(n._buffers[o.type]=[])).push(e)}},e.addEventListener("message",this._handler)}return e.prototype.addEventListener=function(e,t){(this._dic[e]=this._dic[e]||[]).push(t),this.flushBuffer(e)},e.prototype.removeEventListener=function(e,t){var n=this._dic[e];if(n){var r=n.indexOf(t);r>=0&&n.splice(r,1),0===n.length&&delete this._dic[e]}},e.prototype.dispose=function(){this._dic={},this._buffers={},this._receiver.removeEventListener("message",this._handler)},e.prototype.flushBuffer=function(e){var t=this,n=this._buffers[e];n&&0!==n.length&&setTimeout(function(){for(var e=n.length,r=0;r<e;r++)t._handler(n[r]);n.length=0})},e}()},32:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(e,t,n,r){var i=this;this.type=e,this._sender=t,this._receiver=n,this._handler=r,this._response=function(e){var t=e.messageId,n=e.type;i.type===n&&(t?i.awaitResponse(n,e.request,t):i.riseEvent(n,e.request))},n.addEventListener(e,this._response)}return e.prototype.dispose=function(){this._receiver.removeEventListener(this.type,this._response),this._handler.stop()},e.prototype.awaitResponse=function(e,t,n){var r=this._sender;function i(t){var i="";null!=t&&(i=t instanceof Error?t.message:t.toString()),r.postMessage({type:e,messageId:n,error:{message:i}})}function o(t){r.postMessage({type:e,messageId:n,response:t})}try{var s=this._handler.invoke(t);"undefined"!=typeof Promise&&s instanceof Promise?s.then(o,i):o(s)}catch(e){i(e)}},e.prototype.riseEvent=function(e,t){try{this._handler.invoke(t)}catch(e){}},e}()},33:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(4),i=function(){function e(e,t,n){var i=this;this.type=e,this._sender=t,this._receiver=n,this._dictionary={},this._guid=r.a.default,this._response=function(e){var t=e.messageId;if(t){var n=i._dictionary[t];delete i._dictionary[t],n&&(e.error?"function"==typeof n.reject&&n.reject(e.error):"function"==typeof n.resolve&&n.resolve(e.response))}},n.addEventListener(e,this._response)}return e.prototype.send=function(e,t,n){var r=this._guid.next();this._dictionary[r]={resolve:t,reject:n};var i=this._sender.postMessage({type:this.type,messageId:r,request:e});i&&"function"==typeof i.catch&&i.catch(n)},e.prototype.dispose=function(){this._receiver.removeEventListener(this.type,this._response)},e}()},34:function(e,t,n){"use strict";var r=n(17),i=n(5);n.d(t,"a",function(){return o});var o=function(){function e(e,t){this.sender=e,this._time=t}return e.prototype.create=function(e,t){var n={_meta:{type:e}};return t&&function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e||(e={}),Object(i.a)(function(t,n){void 0===e[t]&&(e[t]=n)},e,t)}(n,t),n},e.prototype.send=function(e,t){if(!e||!e._meta)throw new Error("Message or message type is undefined");(e=JSON.parse(JSON.stringify(e)))._meta.timestamp=this._time.now(),e._meta.tabId=r.a.current().tabId,this.sender.send(e,t)},e.prototype.debug=function(e){this.sender.environment({debug:e})},e.prototype.context=function(e){this.sender.context(e)},e}()},4:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),i=function(){function e(e){void 0===e&&(e=o.create()),this.random=e,this._byteToHex=[];for(var t=this._byteToHex,n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1)}return Object.defineProperty(e,"default",{get:function(){return e._default||(e._default=new e)},enumerable:!0,configurable:!0}),e.prototype.next=function(){var e=this.random.next();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,this.bytesToUuid(e)},e.prototype.bytesToUuid=function(e){var t=0,n=this._byteToHex;return n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]+n[e[t++]]},e}(),o=function(){function e(){}return e.create=function(e){return void 0===e&&(e=!1),"undefined"!=typeof crypto&&crypto.getRandomValues&&!e?new s:new u},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.c(t,e),t.prototype.next=function(){var e=new Uint8Array(16);return crypto.getRandomValues(e),e},t}(o),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._rnds=new Array(16),t}return r.c(t,e),t.prototype.next=function(){for(var e=0,t=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),this._rnds[e]=t>>>((3&e)<<3)&255;return this._rnds},t}(o)},5:function(e,t,n){"use strict";function r(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=n[i];if(o)for(var s in o)o.hasOwnProperty(s)&&e(s,o[s])}}n.d(t,"a",function(){return r})},52:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(e){void 0===e&&(e=[]),this.loggers=e,this.enabled=!0}return e.prototype.fatal=function(e,t){this.enabled&&this.logger(function(n){return n.fatal(e,t)})},e.prototype.error=function(e,t){this.enabled&&this.logger(function(n){return n.error(e,t)})},e.prototype.log=function(e){this.enabled&&this.logger(function(t){return t.log(e)})},e.prototype.replace=function(e){this.loggers.length=0;for(var t=e.length,n=0;n<t;n++)this.loggers.push(e[n])},e.prototype.logger=function(e){for(var t=this.loggers,n=t.length,r=0;r<n;r++)e(t[r])},e}()},68:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e||(e={}),Object(r.a)(function(t,n){e[t]=n},e,t),e}},7:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(16),i=function(){function e(e,t){var n=this;this.type=e,this._receiver=t,this.event=new r.a,this._handler=function(e){e.type===n.type&&n.event.emit(e)},t.addEventListener(e,this._handler)}return e.prototype.dispose=function(){this._receiver.removeEventListener(this.type,this._handler),this.event.clear()},e}()},9:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){}return e.addListener=function(t){switch(e.mode){case"pagehide":return window.addEventListener("pagehide",t),!0;case"unload":return window.addEventListener("unload",t),!0;default:return!1}},e.removeListener=function(t){switch(e.mode){case"pagehide":return window.removeEventListener("pagehide",t),!0;case"unload":return window.removeEventListener("unload",t),!0;default:return!1}},e.mode="undefined"!=typeof window?window.onpagehide||null===window.onpagehide?"pagehide":"unload":"none",e}()}})});